{% extends 'layout.html' %}   
{% block body %}
<section id="cover" class="min-vh-100 abs-center">
        <div class="container">
                <div class="col-xl-8 col-lg-6 col-md-8 col-sm-10 mx-auto">
                    <h1 class="display-6 py-2 text-truncate  text-center">Crear kayak</h1>
                        <form action="/kayaks/create" method="post"> 
                          <input type="hidden" name="csrf_token" value = "{{ csrf_token() }}" /> 
                          {% include 'partial/_message.html'%}
                          <div class="row mb-2">
                            <div class="form-group col">
                                <select  name="kayaktypeid"  class="form-control" id="inputRole">
                                    <option value="">Seleccionar tipo de kayak</option>
                                    {%  for tpk in ktype %}
                                      <option value="{{ tpk.id}}"   name="kayaktypeid">{{tpk.name}}</option>
                                    {% endfor %}
                                  </select>
                            </div>
                            <div class="form-group col">
                                <select  name="partner"  class="form-control" id="inputRole">
                                    <option value="">Seleccionar due√±o del  kayak</option>
                                    {%  for part in partners %}
                                       <option value="{{ part.id}}"   name="partner">{{part.firstName }} {{ part.lastName}}</option>
                                    {% endfor %}
                                  </select>
                            </div>
                          </div>

                            <div class="row mb-2">
                              <div class="form-group col">
                                <select  name="hangerid"  class="form-control" id="location">
                                    <option value="">Seleccionar la urbicacion</option>
                                    {%  for urb in locations %}
                                      <option value="{{ urb.id}}"   name="hangerid" onchange="setVariable(urb.id)">{{urb.name}}</option>
                                    {% endfor %}
                                  </select>
                              </div>
                              <div class="form-group col" >
                                <select  name="hangerid"  class="form-control addselect" id="hanger" disabled>
                                  <option value="">Seleccionar el Nro. de la  percha</option>
                                </select>
                              </div>
                            </div>
                            
                            <div class="row mb-2">
                              <div class="form-group col">
                                <select  name="hangerid"  class="form-control" id="inputRole">
                                    <option value="">Seleccionar el percha</option>
                                    {%  for tpk in ktype %}
                                      <option value="{{ tpk.id}}"   name="hangerid">{{tpk.name}}</option>
                                    {% endfor %}
                                  </select>
                              </div>
                              <div class="form-group col">
                                <input type="text" class="form-control" id="nroKayak" placeholder="Nro. Kayak" name="nroKayak">
                              </div>
                            </div>

                            <div class="row mb-2">
                              <div class="form-group col-md-6">
                                <input type="text" class="form-control" id="shovelQuantity"  placeholder="Cantidad de pala" name="shovelQuantity">
                              </div>
                              <div class="form-group col-md-6">                            
                                <input type="text" class="form-control" id="crewmember" placeholder="Cantidad de persona" name="crewmember">
                              </div>
                            </div>
  
                            <div class="float-right mb-3" style="float: right;">
                              <a href="{{ url_for('kayaks.getAll') }}" class="btn btn-primary mr-3">Cancelar</a>
                              <button type="submit" class="btn btn-primary">Guardar</button>
                            </div>
                        </form>
                </div>
        </div>
    <!-- </div> -->
  </section>

  <script  type="text/javascript">
    $( document ).ready(function() {
    $("#location").on("change", function(){
      $.ajax({
          url:`/selectHangers/${$(this).val()}`,
          method: "GET",
          headers: { "Accept": "application/json; odata=verbose" },
          cache: false,
          success: function(resp){
            let divselet = '';
            $(".addselect").empty();
            divselet ='<option value="" name="hangerid">Seleccionar el Nro. de la  percha</option>'
            if(resp.hangers.length > 0){
              $("#hanger").prop('disabled', false);
                for (let index = 0; index < resp.hangers.length; index++) {
                  const element = resp.hangers[index];      
                  divselet +='<option value='+ element.id +' name="hangerid">'+ element.nroHanger +'</option>'
                }
              $(".addselect").append(divselet);
              alert("Success");
            }
            else{
              $("#hanger").prop('disabled', true);
              $(".addselect").append(divselet);
              alert("Error");
            }
          },
          error:function(err){
              $("#hanger").prop('disabled', true);
            alert("Error");
          }
        });
      
      });   
    
    });
  </script>
  {% endblock %}
  
